""" a) solve cos(Ka) = cos(z) + sin(z)/z """

from scipy import optimize
import numpy as np
import matplotlib.pyplot as plt

N = 100
l = np.linspace(0, N-1, N) # l
z = np.zeros(N)
beta = 1

def func(z):
    return np.cos(z) + beta*(np.sin(z)/z) - np.cos(Ka)

zero = 2.0 # chosen from plot on wolfram alpha

for i in range(len(l)):
    Ka = 2*np.pi*l[i]/N
    z[i] = optimize.newton(func, zero)

E1 = np.zeros(N)
E2 = np.zeros(N)
E3 = np.zeros(N)

E1 = z**2
E2 = z**2
E3 = z**2

plt.figure()
plt.plot(z,E1, label="band1")
plt.plot(z,E2, label="band2")
plt.plot(z,E3, label="band3")
plt.legend()
plt.xlabel("z")
plt.ylabel(r"$\frac{\hbar^2}{2ma^2}$")
plt.show()

#wave vectors: 
k = np.sqrt(E1) # the energies are the same as far as I can see. 
print(k)
"""
runexample:
>python3 exercise8_6.py
[1.30654237 1.30802473 1.31246162 1.3198229  1.3300594  1.34310454
 1.35887635 1.37727981 1.39820943 1.42155175 1.44718792 1.47499588
 1.50485253 1.53663537 1.57022403 1.60550137 1.64235435 1.68067462
 1.72035892 1.76130926 1.80343295 1.84664249 1.89085538 1.93599386
 1.9819845  2.02875784 2.07624789 2.12439165 2.1731285  2.22239959
 2.27214708 2.32231328 2.37283967 2.4236656  2.47472674 2.52595303
 2.57726601 2.62857517 2.67977292 2.73072747 2.78127264 2.83119289
 2.88020117 2.92790583 2.97376123 3.01699626 3.05651826 3.09080884
 3.11788143 3.13546437 3.14159265 3.13546437 3.11788143 3.09080884
 3.05651826 3.01699626 2.97376123 2.92790583 2.88020117 2.83119289
 2.78127264 2.73072747 2.67977292 2.62857517 2.57726601 2.52595303
 2.47472674 2.4236656  2.37283967 2.32231328 2.27214708 2.22239959
 2.1731285  2.12439165 2.07624789 2.02875784 1.9819845  1.93599386
 1.89085538 1.84664249 1.80343295 1.76130926 1.72035892 1.68067462
 1.64235435 1.60550137 1.57022403 1.53663537 1.50485253 1.47499588
 1.44718792 1.42155175 1.39820943 1.37727981 1.35887635 1.34310454
 1.3300594  1.3198229  1.31246162 1.30802473]
"""
